<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!--  AutoGenerated by lindzh  2016年12月15日 16:55 -->
<mapper namespace="com.lindzh.hasting.webui.dao.ServiceConsumerInfoDao">

	<resultMap id="ServiceConsumerInfoResultMap" type="com.lindzh.hasting.webui.pojo.ServiceConsumerInfo">
		<id property="id" column="id"/>
		<result property="serviceId" column="service_id"/>
		<result property="serviceAppId" column="service_app_id"/>
		<result property="consumerAppId" column="consumer_app_id"/>
		<result property="comsumerHostId" column="consumer_host_id"/>
		<result property="time" column="consumer_host_uptime"/>
	</resultMap>
	
	<insert id="addServiceConsumerInfo" useGeneratedKeys="true" keyProperty="id" parameterType="com.lindzh.hasting.webui.pojo.ServiceConsumerInfo">
		insert into service_consumer_info(service_id,service_app_id,consumer_app_id,consumer_host_id,consumer_host_uptime)
		 values(#{serviceId},#{serviceAppId},#{consumerAppId},#{comsumerHostId},#{time})
	</insert>
	
	<select id="getById" resultMap="ServiceConsumerInfoResultMap">
		select * from service_consumer_info where id=#{id}
	</select>
	
	<update id="updateById" parameterType="com.lindzh.hasting.webui.pojo.ServiceConsumerInfo">
		update service_consumer_info set service_id=#{obj.serviceId},service_app_id=#{obj.serviceAppId},
		consumer_app_id=#{obj.consumerAppId},consumer_host_id=#{obj.comsumerHostId},consumer_host_uptime=#{obj.time}
		where id=#{obj.id}
	</update>
	
	<delete id="deleteById">
		delete from service_consumer_info where id=#{id}
	</delete>
	

	<select id="getListByServiceId" resultMap="ServiceConsumerInfoResultMap">
		select * from service_consumer_info where
		service_id=#{serviceId}
		order by id desc limit #{limit} offset #{offset}
	</select>
	
	<select id="getCountByServiceId" resultType="long">
		select count(*) from service_consumer_info where 
		service_id=#{serviceId}
	</select>
	
	
	<select id="getListByServiceAppId" resultMap="ServiceConsumerInfoResultMap">
		select * from service_consumer_info where
		service_app_id=#{serviceAppId}
		order by id desc limit #{limit} offset #{offset}
	</select>
	
	<select id="getCountByServiceAppId" resultType="long">
		select count(*) from service_consumer_info where 
		service_app_id=#{serviceAppId}
	</select>
	
	
	<select id="getListByConsumerAppId" resultMap="ServiceConsumerInfoResultMap">
		select * from service_consumer_info where
		consumer_app_id=#{consumerAppId}
		order by id desc limit #{limit} offset #{offset}
	</select>
	
	<select id="getCountByConsumerAppId" resultType="long">
		select count(*) from service_consumer_info where 
		consumer_app_id=#{consumerAppId}
	</select>
	
	
	<select id="getListByConsumerHostId" resultMap="ServiceConsumerInfoResultMap">
		select * from service_consumer_info where
		consumer_host_id=#{comsumerHostId}
		order by id desc limit #{limit} offset #{offset}
	</select>
	
	<select id="getCountByConsumerHostId" resultType="long">
		select count(*) from service_consumer_info where 
		consumer_host_id=#{comsumerHostId}
	</select>

	<delete id="deleteByConsumerAppIdAndHostId">
		delete from service_consumer_info where
		consumer_app_id=#{consumerAppId} and consumer_host_id=#{comsumerHostId}
	</delete>

	<select id="getConsumer" resultMap="ServiceConsumerInfoResultMap">
		select * from service_consumer_info where
		service_app_id=#{serviceAppId} and service_id=#{serviceId}
		and consumer_app_id=#{consumerAppId} and consumer_host_id=#{comsumerHostId}
	</select>
	
	<select id="getServiceConsumeCount" resultType="long">
		select count(*) from service_consumer_info where
		service_app_id=#{serviceAppId} and service_id=#{serviceId}
	</select>
	
</mapper>